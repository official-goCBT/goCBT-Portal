<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#00d4ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>goCBT | Integrated Portal</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>

<div id="errorToast">
    <span class="icon">‚ö†Ô∏è</span>
    <span id="errorMessage">Invalid Credentials</span>
</div>

<div class="container">
    <div id="authCard" class="auth-card">
        <div class="logo">goCBT</div>
        <h2 id="formTitle">Student Portal</h2>

        <div class="role-toggle">
            <input type="radio" name="role" id="stuTab" checked onclick="switchForm('student')">
            <label for="stuTab">Student</label>
            <input type="radio" name="role" id="facTab" onclick="switchForm('facilitator')">
            <label for="facTab">Facilitator</label>
            <div id="slider" class="toggle-slider"></div>
        </div>

        <form onsubmit="event.preventDefault(); handleLogin();">
            <div class="input-group">
                <label id="idLabel">Registration Number</label>
                <input type="text" id="userID" placeholder="e.g., 2024/CS/001" required>
            </div>

            <div class="input-group">
                <label id="passLabel">Access PIN</label>
                <div class="password-wrapper">
                    <input type="password" id="userPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    <span class="toggle-password" id="toggleIcon" onclick="togglePasswordVisibility()">SHOW</span>
                </div>
            </div>

            <button type="submit" class="btn btn-primary" id="submitBtn">
                <span class="btn-text">Sign In to Portal</span>
                <div class="spinner" id="btnSpinner"></div>
            </button>
        </form>

        <div class="auth-footer" id="authFooter">
    </div>
    <div id="adminView" class="auth-card admin-card hidden">
        <div class="admin-header">
            <div class="logo" style="font-size: 1.5rem;">goCBT Admin</div>
            <button class="btn btn-danger" style="width:auto;" onclick="logout()">Logout</button>
        </div>
        <h3 id="adminWelcome">Dashboard</h3>
        <div class="stats-grid">
            <div class="stat-item"><span>Logins</span><div id="totalLogs">0</div></div>
            <div class="stat-item"><span>Active Today</span><div id="activeUsers">0</div></div>
        </div>
        <input type="text" id="searchBar" onkeyup="searchTable()" placeholder="üîç Search records...">
        <div style="overflow-x: auto;">
            <table>
                <thead><tr><th>Student</th><th>Reg No</th><th>Logs</th><th>Last Seen</th></tr></thead>
                <tbody id="auditBody"></tbody>
            </table>
        </div>
    </div>
</div>
<div id="admissionModal" class="modal hidden">
    <div class="modal-content auth-card">
        <span class="close-btn" onclick="toggleAdmission(false)">&times;</span>
        <div class="step-indicator">
            <div class="step active" id="s1">1</div>
            <div class="step" id="s2">2</div>
            <div class="step" id="s3">3</div>
        </div>
        <form id="admissionForm">
            <div class="form-step" id="step1">
                <h3>Personal Info</h3>
                <input type="text" name="user_name" placeholder="Full Name" required>
                <input type="email" name="user_email" placeholder="Email Address" required style="margin-top:10px">
                <button type="button" class="btn btn-primary" onclick="nextStep(2)" style="margin-top:15px">Next</button>
            </div>
            <div class="form-step hidden" id="step2">
                <h3>Academic Details</h3>
                <select name="dept" class="custom-select">
                    <option value="Computer Science">Computer Science</option>
                    <option value="Engineering">Engineering</option>
                </select>
                <input type="text" name="qualify" placeholder="Qualification" style="margin-top:10px">
                <div style="display:flex; gap:10px; margin-top:15px">
                    <button type="button" class="btn" onclick="nextStep(1)">Back</button>
                    <button type="button" class="btn btn-primary" onclick="nextStep(3)">Next</button>
                </div>
            </div>
            <div class="form-step hidden" id="step3">
                <h3>Ready to Submit?</h3>
                <p>Data will be sent to gocbtinfo@gmail.com</p>
                <button type="submit" class="btn btn-secondary">Submit Application</button>
            </div>
        </form>
    </div>
</div>

<div style="display:none;">
    <div id="resultSlipTemplate" style="padding: 50px; color: #000; background: #fff;">
        <h1 style="text-align:center">goCBT RESULT SLIP</h1>
        <hr>
        <p><strong>Student:</strong> <span id="pdfName"></span></p>
        <p><strong>Reg No:</strong> <span id="pdfReg"></span></p>
        <p><strong>Score:</strong> <span id="pdfScore">88%</span></p>
        <div id="pdfQRSpace" style="margin-top:20px"></div>
    </div>
</div>
<script src="script.js"></script>
</body>
</html>
